var dfs;

dfs = require('./dfs');

module.exports = function(path, type) {
  return dfs.stat(path).then(function(stat) {
    if (type == null) {
      return path;
    }
    if (type === 'File' || type === 'Directory' || type === 'Socket' || type === 'BlockDevice' || type === 'CharacterDevice' || type === 'SymbolicLink' || type === 'FIFO') {
      if (stat["is" + type]()) {
        return path;
      }
    }
    throw new Error("bad type: " + type);
  })["catch"](function(e) {
    if (e.code === "ENOENT") {
      return;
    }
    throw e;
  });
};
